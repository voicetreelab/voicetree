Here's an improved version of the prompt, focusing on clarity, structure, and conciseness:

```python:tree_manager/LLM_engine/prompts/multi_node_update_pseudocode_prompt.py
def create_context_prompt(tree, recent_nodes, new_text, transcript_history):
    """Constructs the prompt for the LLM to analyze context and update the tree."""

    prompt = f"""You are an AI assistant tasked with converting live voice transcripts into a visual tree structure. Your goal is to process text chunks and update a tree representation that accurately reflects the speaker's content.

Context:
- Recent nodes: {str(recent_nodes)}
- Transcript history: {transcript_history[:100]}... (truncated)
- New input: {new_text}

Instructions:
1. Analyze the new input in the context of recent nodes and transcript history.
2. For each concept in the new input:
   a. Identify the most relevant existing node or decide to create a new one.
   b. Determine the relationship between the concept and its parent node.
   c. Summarize the concept concisely in markdown format.

Output Format:
For each concept, provide:
1. Concept: [Brief description]
2. Relevant Node: [Existing node title or "New"]
3. Action: [APPEND or CREATE]
4. Relationship: [Child of | Parent of | Related to | Depends on | Prerequisite for | Clarification of | Example of]
5. Markdown Summary:
   ## [Concise title (up to 7 words)]
   **[Brief summary (up to one paragraph)]**
   - [Key point 1]
   - [Key point 2]
     - [Sub-point if necessary]

Example Output:
- Concept: Agile methodology benefits
- Relevant Node: Software Development Practices
- Action: APPEND
- Relationship: Example of
- Markdown Summary:
  ## Benefits of Agile in Software Development
  **Agile methodology improves project flexibility and team collaboration.**
  - Faster delivery of working software
  - Increased customer satisfaction
    - Regular feedback loops

Provide your analysis for each concept in the new input, following this format.
"""

    return prompt
```
